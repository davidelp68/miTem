(function(){"use strict";let a,b={name:"miTem",version:"0.1"},c={statement:/\{\%([\s\S]+?)\%\}/g,expression:/\{\{([\s\S]+?)\}\}/g,filter_param:/([\s\S]+?)(\(([^)]+?)\))$/},d={if:(...a)=>(console.log(a[1]),"if(c."+b.processFilters(a[1])+"){"),else:(...a)=>"}else "+("if"==a[1]?d.if("",a[2]):"{"),endif:()=>"}",endfor:()=>"}c=c.loop.parent;",for:(...a)=>{let b="var t={loop:{parent:c,length:c."+a[3]+".length}};c=t;var i=0;";return b+="if(typeof c.loop.parent."+a[3]+".length === 'undefined')",b+="{c.loop.length=m.objSize(c.loop.parent."+a[3]+")}",b+="for("+a[1]+" in c.loop.parent."+a[3]+"){",b+="if (!c.loop.parent."+a[3]+".hasOwnProperty("+a[1]+"))continue;",b+="c."+a[1]+"=c.loop.parent."+a[3]+"["+a[1]+"];",b+="c.loop.last=(i===c.loop.length-1);",b+="c.loop.first=(i===0);",b+="c.loop.index0=i; c.loop.index=i+1;i++;",b}};b.objSize=a=>{let b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},b.retoreDefaultSettings=function(){b.settings={stopOnError:!1}},b.retoreDefaultSettings(),b.filters={default:function(a){return"undefined"==typeof this?a:this}},b.filters.prototype=String,a=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):a.miTem=b,b.processFilters=a=>{let b,d=a.trim().split("|"),e="c."+d[0],f=d.slice(1);for(const d of f){b=c.filter_param.exec(d.trim())||["",d.trim(),"",""];let a=b[3].split(","),f="(typeof s.m.filters['"+b[1]+"']!=='undefined')?";f+="s.m.filters['"+b[1]+"'].apply("+e+",["+a.toString()+"]):",f+=e+"."+b[1]+"("+b[3]+")",e=f}return e},b.compile=a=>{let f="var c=d;var m=this.miTem;var o='",g=a.split("\n"),h="";for(const[e,i]of g.entries())f+=h,f+=i.replace(c.statement,function(){let a=arguments[1].trim().split(" ");return"';"+d[a[0]].apply(null,a)+"o+='"}).replace(c.expression,function(){let a=arguments[1],c=b.processFilters(a);return c="(function(){var s=this,t;s.m=m;try{return "+c+"}catch(e){console.error('Line: "+(parseInt(e)+1)+"; Error in "+arguments[0].replace(/'/g,"\\'")+"');",b.settings.stopOnError&&(c+="throw e;"),c+="}})()","'+"+c+"+'"}),h="'+\"\\n\"+'";f+="'; return o;";try{return function(a){let c=new Function("d",f),d={};return d.miTem=b,d.scopeFilters=[],c.apply(d,[a])}}catch(a){console.error(f),console.error(a)}}})();